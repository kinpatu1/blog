AWSのサービスEC2についてまとめました（4）

前回はEC2を起動する時に、インスタンスに対して必要最低限の設定しかしませんでしたが、他にも便利な設定がたくさんあったので、今回はそれらを説明していきます。

続きを読む
🔗スポットインスタンス
AWSが余らせているEC2リソースを入札形式で利用できます。

例えば、0.5USD/時が現在価格のEC2を、1USD/時の間だけ利用するといった設定が可能です

1USD/時を超えるとEC2は使えなくなるので、短期的に低価格でEC2を使いたい時に有効です。

🔗配置グループ
インスタンス間の通信速度を高速化させる機能で、三種類あります。

🔗クラスタープレイスメントグループ
単一のアベイラビリティーゾーン内のインスタンスを論理的にグループ化したものです。

プレイスメントグループの種類の中でも、一番シンプルなものです。

画像に alt 属性が指定されていません。ファイル名: Untitled-Diagram.png
🔗パーティションプレイスメントグループ
パーティションという枠に複数のインスタンスを入れることができ、単一アベイラビリティーゾーン内に複数のパーティションを作成することができます。

各パーティションには、独自のネットワークおよび電源があるが、プレイスメントグループ内のパーティションどうしが、これらを共有することはできないです。

画像に alt 属性が指定されていません。ファイル名: Untitled-Diagram-1.png
🔗スプレッドプレイスメントグループ
スプレッドプレイスメントグループに作成されたインスタンスは、それぞれに独自のネットワークおよび電源を持っています。

パーティションプレイスメントグループとの違いは、各グループには一つのインスタンスがあり、それぞれに独自のネットワークおよび電源を持っているという点です。

画像に alt 属性が指定されていません。ファイル名: Untitled-Diagram-2.png
🔗キャパシティーの予約
キャパティティーの予約を作成する時は、指定された容量を予約します。

予約された容量は、インスタンスがその容量で実行中かどうかにかかわらず、選択されたインスタンスタイプのオンデマンド料金で課金されます。

必要に応じてキャパシティーを増減することができます。

🔗IAMロール
インスタンスが他のAWSリソースに対して行う動作を定義できます。


画像に alt 属性が指定されていません。ファイル名: Untitled-Diagram-3.png
🔗シャットダウン動作
EC2ダッシュボード上でインスタンスの停止をする時には影響はありません。

<a href="https://aws.miki0116.com/2020/07/30/ec2-2/" target="_blank" rel="noopener noreferrer">前回</a>の記事の様にインスタンスにアクセスした上で、コマンドでインスタンスを停止させる時に、停止状態にするのか、終了させるのか選べます。
🔗停止 - 休止動作
停止動作と休止動作は、インスタンスを削除しないで料金が発生しない状態にするという点は同じです。

休止動作では起動中のデータをルートボリュームに保存してから、stopped状態に移行できます。

🔗終了保護の有効化
インスタンスを誤って終了しないように保護することができます。

有効にしていると、終了保護を無効にしない限り、このインスタンスを終了できなくなります。

🔗モニタリング
CPU使用率等の数字を収集することができます。

デフォルトの状態では無料で5分間隔で収集できます。

有料化にすると1分間隔で収集できます。

🔗テナンシー
<a href="https://aws.miki0116.com/2020/07/06/vpc/#i-2" target="_blank" rel="noopener noreferrer">前回</a>の記事を参考にしてください。
🔗Elastic Inference
ディープラーニングの推論を実行するコストを最大 75% まで削減できます。

ディープラーニングはGPUをたくさん使うので、外付けでGPUをつけることができます。

ディープラーニングを行う時にGPU、CPUには一長一短があるので、CPUインスタンスにGPUを外付けするということもできます。

🔗T2/T3 無制限
インスタンスにたくさんの負荷がかかった時、自動的にCPU処理能力がスケールアップする様になっています。

通常、スケールアップする時には、クレジットというスケールアップした状態が継続できる時間が必要です。

スケールアップする時に、クレジットを使わずに課金する方法をT2/T3 無制限と言います。

🔗ファイルシステム
EFSを利用するために必要な設定です。

🔗Metadata accessible
メタデータとはインスタンスに関するデータで、実行中のインスタンスを設定または管理するために使用します。

Metadata accessibleを設定することで、Metadata version、Metadata token response hop limitの設定をすることができます。

🔗Metadata version
アプリケーションが利用するインスタンス、ネットワーク、およびストレージに関するメタデータを管理する方法でV1、V2があります。

V2の方が新しく、メタデータにアクセスを試みる可能性がある４種類の脆弱性に対して、新しい保護を追加します。

🔗Metadata token response hop limit
ホップ 数とは通信ネットワーク上で、通信相手に到達するまでに経由する転送・中継設備の数のことです。

相手までの距離や経路の長さを表す指標としてよく用いられます。

🔗ユーザーデータ
EC2を起動する時に、EC2に対して行う動作を定義することができます。

#!/bin/bashが必須、sudoコマンド使えない等、書き方にはいくつかのルールがあります。

以下はアパッチをインストール、自動起動の設定を定義したものです。

#!/bin/bash
yum -y install httpd
service httpd start
systemctl enable httpd.service

- Lang Select -
data-line属性値
ファイル名
まとめ
IAMロール、終了保護の有効化、ユーザーデータ等は便利と思いました。

専門的なことをする時に必要な設定もいくつかあるので、こんな物があったなくらいでも覚えておこうと思います。

