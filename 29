サンドボックス外に移動しSESでメールを送信してみた

今回、メールの受信はしないが送信にだけSESを利用する機会がありました。

この時、サンドボックス問題という初耳の言葉があり、解決するのに少し時間がかかったのでここにまとめておきます。

続きを読む
🔗サンドボックスについて
サンドボックスとはIT業界では、外部から隔離された領域では通常通り利用することができるが、外部との通信には制限をかけた場所になります。

SESにもサンドボックスがあり、利用し始めた時にはいくつかの制限があります。

①ドメイン、Eメール検証をした「送信先」にしかメールを送れない

②ドメイン、Eメール検証をした「送信元」からでしかメールを送れない

③一日に送れるメールの件数

これらの制限はAWSのサポートセンターに申請することで解除することができます。

🔗ドメインの検証方法
SESで自分が保有しているドメインを利用するには、ドメインを保有していることを証明する必要があります。

そのためにはRoute53にいくつかのレコードを登録します。

🔗ドメインの設定
SESのダッシュボードから「Domains」>「verify a new domain」をクリックします。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-09-21.33.12-1024x420.png
Routre53に登録しているドメインまたはサブドメインを入力し、DKIMの設定にもチェックを入れます。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-09-21.33.49-1024x430.png
「email receiving record」と「hosted zones」で使いたいドメインにチェックを入れ「Create Record Sets」をクリックします。

もしドメインをAWS外で管理していないのならば、全てのレコードを登録します。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-09-21.34.50-1024x562.png
しばらくすると三項目が緑色になります。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-09-21.36.24-1024x413.png
ドメインの検証はできました。

🔗Eメールアドレスの検証方法
SESで自分が保有しているEメールアドレスを利用するには、Eメールアドレスを保有していることを証明する必要があります。

そのためにはSESに登録する「送信元」アドレスで、AWSからの送信元確認メールを受信する必要があります。

🔗Eメールアドレスの設定
SESのダッシュボードから「Email Addresses」>「verify a new domain」をクリックします。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-10-16.22.43-1536x619-1-1024x413.png
利用したいEメールアドレスを入力します。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-10-16.21.19-1024x412.png
入力したEメールアドレス宛にメールが来るので、一番上のURLをクリックします。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-10-16.25.43-1024x533.png
すぐにverifiedに変わります。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-10-16.27.28-1024x413.png
ドメインの検証はできました。

🔗サポートセンターへの申請
どのダッシュボードからでも良いが、「サポート」>「サポートセンター」をクリックします。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-09-21.46.02-1024x420.png
「Create case」をクリックします。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-09-21.46.33-1024x380.png
「Service limit increase」>「SES送信制限」をクリックし「メールの種類」では一番合うものを選択します。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-09-21.58.41-1024x561.png
「AWSサービス条件とAUPを遵守しますか？」にチェックを入れ、「Request1」で特にこだわりがなかったら、以下の様に入力してください。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-09-21.58.55-1024x561.png
「Case description」も特にこだわりがなければ、以下の様に入力してください。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-09-21.59.08-1024x564.png
早ければ半日でAWSから返答がきます。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-10-10-16.44.59-1024x380.png

﻿

料金表
画像に alt 属性が指定されていません。ファイル名: Untitled-Diagram-4.png
まとめ
今回はSESでメールの送信しましたが、S3を使ってメールの受信をする方法も学習したので、次回以降記事を書きたいと思います。

今回の件で自分には分からないことだらけなのが分かったので、これからもっと幅広く学習していこうと思います。

