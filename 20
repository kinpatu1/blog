ALB+AutoScallingの設定をしました（１）


今回はAWSの定番のネットワーク構成であるALB+AutoScallingを二回に分けて書いていきます。

第一回目は、AutoScallingの設定について説明します。

作成するネットワーク構成は以下になります。


目次 [非表示]

1 🔗事前準備
2 🔗Apacheのインストール
3 🔗AMIの作成
4 🔗AutoScallingの設定
5 料金表
6 まとめ
🔗事前準備
VPCとアベイラビリティーゾーンa、アベイラビリティーゾーンbにインスタンスを作成しておいてください。


🔗Apacheのインストール
AutoScallingを利用する時は、webサーバをスケールアウトすることが多いかと思うので、今回はインスタンスにApacheをインストールしておきます。

インスタンスにアクセスして以下コマンドを打ってください。

# Apacheをインストールします
sudo yum -y install httpd
# Apacheを起動します
sudo service httpd start
# Apacheを自動起動させます
sudo systemctl enable httpd.service
🔗AMIの作成
Apacheをインストールしたインスタンスを選択し、「インスタンスの状態」>「停止」を選択します。


「アクション」>「イメージ」>「イメージの作成」を選択します。


AMIに管理しやすい名前をつけます。


🔗AutoScallingの設定
EC2ダッシュボードから「Launch Configurations」>「起動設定の作成」をクリックします。


先程作成したAMI、インスタンスタイプを選択してください。


同じ画面で「セキュリティグループ」、「キーペア」を選択し最後のチェックボックスにチェックを入れてください。。

以上で「起動設定」を作成できました。

作成した「起動設定」を選択し、「アクション」>「Autoscallingグループの作成」を選択します。


次の画面で「起動設定」は選択されているので、Autoscallingグループ名を記入してください。

Autoscallingを利用してインスタンスを作成したいVPC、サブネットを選択します。


次の画面では何も変更しないです。

作成したいインスタンス数を選択します。

最大キャパシティはインスタンスへの負荷が高まった時に、スケールアウトする最大数です。


後の画面は変更しないで大丈夫です。

以上でAutoscallingの設定ができたので、インスタンスが２つ作成されています。

料金表

まとめ
Autoscallingを設定することで可用性を高めることができます。

インスタンスを消したい時には、先にAutoscallingを消さないと、Autoscallingの設定があるとインスタンスを消しても何度も作成されてしまいます。

また、同じ条件でAutoscallingの設定をする時のために、起動設定は消さないことをおすすめします。

カテゴリー