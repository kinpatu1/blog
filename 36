プレフィックスリストでインバウンドルールを簡単に設定

下の図の様に、複数企業の複数部署で開発をしていて、頻繁にインバウンドルールの設定変更をするシチュエーションがあるとします。

この様な時、何度もインバウンドルールを追加、削除するのは面倒ですし、ミスに繋がるのでなるべく避けたいものです。

今回、sysopsの勉強をする中で、この問題を解決できるプレフィックスリストというサービスについて学んだので、ここにまとめておきます。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-11-17-23.23.27-1024x565.png
続きを読む
🔗プレフィックスリストとは
上記の図でいうソース（インバウンドを許可するipアドレス）を、プレフィックスリストに複数設定することができます。

例えば、プレフィックスリストに登録しておいたソースから、サブネットへのインバウンドを許可したい場合は、ルートテーブル のインバウンドルールにプレフィックスリスト IDを書き込みます。

🔗マネージドプレフィックスリスト
デフォルトでdynamoDB、S3を利用できます。

しかし、マネージドプレフィックスリストを作成、変更、共有、削除することはできません。

セキュリティグループ、ルートテーブルに利用することができます。

🔗カスタマーマネージドプレフィックスリスト
IPv4、IPv6 CIDRブロック定義のプレフィックスリストをセキュリティグループ、ルートテーブル、トランジットゲートウェイで利用することができます。

マネージドプレフィックスリストを作成、変更（一部）、共有、削除することができます。

🔗エントリ数
プレフィックスリストに追加することができる、ipアドレスの最大数を最初に定義する必要があります。

こちらは後で変更することはできないの注意してください。

🔗バージョン
プレフィックスリストのエントリを追加または削除するたびに、新しいバージョンのプレフィックスリストが作成されます。 

以前のバージョンに戻すこともできます。

🔗プレフィックスリスト の各種設定
🔗プレフィックスリストのエントリ 
プレフィックスリストに設定したipアドレス一覧を見ることができます。

🔗プレフィックスリストの関連付け
ルートテーブル等にプレフィックスリストを利用すると、ルートテーブル 等対象のリソースが表示されます。

🔗リソース共有
Resource Access Managerで設定をすると、プレフィックスリストを外部アカウントと共有するためのARNを表示することができます。

🔗プレフィックスリストを変更
プレフィックスリスト名と、作成時に設定した範囲内でプレフィックスリストのエントリ数の変更をすることができます。

🔗プレフィックスリストを復元
以前のバージョンを再度設定することができます。

🔗CIDR(CSV)をエクスポート 
CIDRでエクスポートされるのはCIDRだけで、説明等は表記されていないです。


﻿

料金
画像に alt 属性が指定されていません。ファイル名: Untitled-Diagram-15.png
まとめ
今回使って思ったことは、同じプレフィックスリストをセキュリティーグループ、ルートテーブル に使えるのがとても良かったです。

セキュリティーグループ、ルートテーブルに対して、同じ設定をできるのはこの機能だけかと思います。

