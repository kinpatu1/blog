スポットインスタンスを作成してみた(3)

今回はスポットリクエストを作成し、スポットインスタンスを起動する方法についてまとめていきます。

この方法では、複数のインスタンスタイプの中から、スポットインスタンスを作成できる点でとても良いかと思います。

続きを読む
🔗アプリケーションまたはタスクのニーズについてお知らせください
🔗ワークロードのロードバランシング
このワークロードを利用することで、基本的な設定をしたスポットインスタンスを作成することができます。

🔗柔軟なワークロード
バッチジョブCI/CD ジョブを行う時に推奨されている方法になります。

🔗ビッグデータのワークロード
Amazon EMR、Hadoop、Spark を利用して大量のデータを処理する時に推奨されている方法になります。

🔗定義された期間のワークロード
後ほど説明するフリートリクエストを利用しないで、スポットインスタンスを作成する方法になります。

そのため、前回の記事で説明したスポットインスタンスの作成方法と設定項目は同じになります。

🔗インスタンスの設定
🔗起動テンプレート、AMI、ネットワーク、キーペア名
以前の記事を参考にしてください。

🔗最小コンピュートユニット
インスタンスを起動する時にどれくらいの容量のインスタンスを起動するのかを決めます。

🔗仕様として
vCPU、メモリをどのくらいの容量にするのか選べます。

インスタンスタイプを選ぶよりか柔軟に設定できるかと思います。

🔗インスタンスタイプとして
いろんなインスタンスタイプ、インスタンスサイズの中から選ぶことができます。

インスタンスタイプにはそれぞれ特徴があるので、利用シーンに合わせて選ぶ必要があります。

インスタンスタイプに関してはこちらを参考にしてください。

🔗アベイラビリティーゾーン
インスタンスを起動するサブネットを選択します。

🔗追加設定
🔗EBS 最適化、EBS ボリューム、モニタリング、テナンシー、セキュリティグループ、IPv4 パブリック IP の自動割り当て、IAM インスタンスプロフィール、ユーザーデータ
以前の記事を参考にしてください。

🔗インスタンスストア
「インスタンスストアを作成時にアタッチする」をしないと、インスタンスストアがつかない様です。

🔗Tags
インスタンス、スポットリクエストに対してタグ付けすることができます。

画像に alt 属性が指定されていません。ファイル名: スクリーンショット-2020-12-15-23.32.46-1024x328.png
🔗必要な容量をお知らせください
🔗合計ターゲット容量
起動するターゲット容量をインスタンス数または vCPU 数によって定義することができます。

起動テンプレートを指定することで、合計ターゲット容量の中でもオンデマンドインスタンスをいくつ作成するのか指定することができます。

🔗ターゲット容量を維持する
こちらをチェックすると中断動作の設定をすることができます。

中断動作に関してはこちらを参考にしてください。

🔗キャパシティーの再調整
こちらを参考にしてください。

🔗スポットインスタンスの最大コストを設定する
スポットインスタンスを複数のインスタンスタイプで、複数個起動する際に一時間あたりの最大コストを指定することができます。

🔗フリートリクエストの設定
推奨事項の適用を選択すると、AWSが推奨してくれているフリートを利用することができます。

上記フリートは「フリートからインスタンスプールのさまざまなセットを使用して、容量のリクエストを満たします。このオプションにより、広範な同時中断を回避し、より一貫性のある保存を実現できます。」を達成している様です。

チェックボックスからチェックを外すと、自分でインスタンスタイプを選んで、フリートを作成することができます。

また、自分でフリートを作成する時には、フリートの配分戦略でフリートの中から、どのインスタンスを作成するのか、ルールを決める必要があります。

🔗その他のリクエスト詳細
この設定ではスポットインスタンスに払っても良い金額や、リクエストの有効期間を決めることができます。

また、ロードバランサーの配下に置く様に設定することができます。


料金表
画像に alt 属性が指定されていません。ファイル名: Untitled-Diagram-20.png
まとめ
スポットインスタンスを作成する方法を一通り紹介しましたが、テンプレートとして残せるだとか、フリートを作成できるとかそれぞれに一長一短があるかと思います。

そこはこれから使い慣れていけたらと思います。

