スポットインスタンスを作成してみた(1)


スポットインスタンスについてなんとなく理解していましたが、今回sysopsの勉強をする中で色々便利な機能があることが分かったので、複数回に分けてまとめていきます。

EC2コンソールのどの画面でスポットインスタンスを起動するかによって、設定内容が変わります。

今回はEC2作成画面より起動します。

続きを読む
🔗スポットインスタンスとは
スポットインスタンスとは、AWSが利用していないインスタンスを格安で利用できる方法になります。

特徴としてはその時によって、料金が変化する点です。

そのため下の図の様に「購入するのに払っても良い金額」が、「現在価格」よりも高ければスポットインスタンスを起動することができます。（逆に安ければ起動できない）

イメージはオークションの様なものです。(所持金の範囲内でオークション価格が決まらないと、落札できないですよね)

注意していただきたいのは一度インスタンスを起動しても、「購入するのに払っても良い金額」より「現在価格」が高くなってしまうと、起動中のインスタンスは中断される点です。

画像に alt 属性が指定されていません。ファイル名: Untitled-Diagram-2-1.png
🔗スポットインスタンスの各種設定
🔗現在の価格
上の図でいう「現在価格」です。

起動したいリージョン、AZ、インスタンスサイズによって料金は変化します。

🔗最高価格
上の図でいう「購入するのに払っても良い金額」です。

この価格が「現在の価格」よりも高い時に、インスタンスは起動します。

🔗永続的リクエスト
「現在の価格」が「最高価格」を超え、インスタンスが中断された後の動作を定義することができます。

永続的リクエストにチェックを入れていると、「現在の価格」が「最高価格」を下回ると、再度スポットインスタンスが起動されます。

逆にチェックを入れていないと、一度スポットインスタンスが中断されると、その後自動で起動されることはないです。

画像に alt 属性が指定されていません。ファイル名: Untitled-Diagram-18-1024x684.png
🔗中断動作
インスタンスが中断された時に、停止するのか、終了するのかを選択することができます。

以前は中断が発生すると、終了するしかなかった様ですが、現在は停止状態にし「現在の価格」が「最高価格」を下回ると、停止状態から開始されます

🔗リクエスト有効期間の終了
永続的リクエストを出しておく時間を指定することができます。

料金表
画像に alt 属性が指定されていません。ファイル名: Untitled-Diagram-4-1.png
まとめ
基本的にはインスタンスがいつ中断されても良い様な作業をするのに適している様です。

そのため、EC2で行った作業のデータはEC2で保持するのではなく、RDSやS3といったデータベースに移動する設計にしておく必要がある様です。

スポットインスタンスの起動方法の中でも、今回の方法は比較的簡単に設定できるかと思いました。

